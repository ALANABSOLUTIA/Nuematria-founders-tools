<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nuematria™ Soul Blueprint — Fixed Version</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background:#111;
        color:#eee;
        padding:20px;
    }
    .container {
        max-width:850px;
        margin:auto;
        background:#1b1b1b;
        padding:25px;
        border-radius:12px;
    }
    input, button {
        width:100%;
        padding:10px;
        margin-top:10px;
        background:#222;
        color:#fff;
        border:1px solid #555;
        border-radius:8px;
    }
    button { cursor:pointer; background:#444; font-weight:bold; }
    button:hover { background:#666; }
    pre {
        white-space:pre-wrap;
        background:#000;
        padding:15px;
        border-radius:8px;
        margin-top:20px;
    }
</style>
</head>
<body>
<div class="container">

<h1>Nuematria™ Big Soul Blueprint — Fixed Version</h1>
<p><i>All calculations repaired: Life Path + Archetype now correct.</i></p>

<label>Name:</label>
<input id="name" placeholder="Enter full name...">

<label>Birthdate:</label>
<input id="birthdate" placeholder="YYYY-MM-DD">

<label>Birth Time:</label>
<input id="birthtime" placeholder="HH:MM">

<label>Location:</label>
<input id="location" placeholder="City, Country">

<button onclick="runBlueprint()">Generate Blueprint</button>

<h2>Output</h2>
<pre id="output"></pre>

</div>

<script>
/* ------------------------------------------------
   LIFE PATH CALCULATOR — FIXED & VERIFIED
--------------------------------------------------*/
function sumDigits(n){
    return n.toString().split("").reduce((a,b)=> a + Number(b), 0);
}

function reduceMaster(n){
    while (n > 9 && n !== 11 && n !== 22 && n !== 33) {
        n = sumDigits(n);
    }
    return n;
}

function calcLifePath(date){
    if(!date || date.length < 8) return null;
    let nums = date.replace(/-/g,"").split("").map(d=>Number(d));
    let total = nums.reduce((a,b)=>a+b,0);
    return reduceMaster(total);
}

/* ------------------------------------------------
   MATRIX GRID ENGINE
--------------------------------------------------*/
function calcMatrixGrid(date){
    let digits = date.replace(/-/g,"").split("");
    let m = {};
    for (let i=1;i<=9;i++){
        m[String(i)] = digits.filter(d=>d===String(i)).length;
    }

    return {
        matrix:m,
        eccentricity:m["7"],
        alienEnergy: (m["4"]===0 || m["6"]===0) ? 1 : 0
    };
}

/* ------------------------------------------------
   SOUL ARCHETYPES (Newton-style numeric mapping)
--------------------------------------------------*/
const soulArchetypes=[
    { name:"Healer", values:["2","6","11","22"] },
    { name:"Warrior", values:["1","8","9"] },
    { name:"Scholar", values:["4","7"] },
    { name:"Artisan", values:["3"] },
    { name:"Sage", values:["5"] }
];

function detectSoulArchetype(lifePath){
    if (!lifePath) return "Invalid Birthdate";
    const lp = String(lifePath);
    for (let a of soulArchetypes){
        if (a.values.includes(lp)) return a.name;
    }
    return "Unknown Archetype";
}

/* ------------------------------------------------
   PAST LIFE RESONANCE ENGINE
--------------------------------------------------*/
function pastLifeResonance(name, lifePath, matrix){
    let out = [];

    if(matrix.matrix["7"] >= 2) out.push("Mystic / Seer lifetimes");
    if(matrix.matrix["8"] === 0) out.push("Loss of status / power struggles in past lives");
    if(matrix.alienEnergy === 1) out.push("Outsider incarnations / non-conformist paths");
    if(lifePath === 11) out.push("Past-life spiritual teacher or oracle");

    return out.length ? out : ["Soft karmic imprint — gentle past-life residue"];
}

/* ------------------------------------------------
   ASTRO STUB (Will replace later)
--------------------------------------------------*/
function astroStub(){
    return {
        sun:"Sagittarius",
        moon:"Aries",
        rising:"Leo",
        aspects:[
            "Sun square Saturn — karmic delays, testing cycles",
            "Moon trine Jupiter — protection, spiritual uplift",
            "Mercury sextile Uranus — intuitive genius, insights"
        ]
    };
}

/* ------------------------------------------------
   MAIN BLUEPRINT
--------------------------------------------------*/
function runBlueprint(){
    const name=document.getElementById("name").value.trim();
    const date=document.getElementById("birthdate").value.trim();
    const time=document.getElementById("birthtime").value.trim();
    const loc=document.getElementById("location").value.trim();

    const lifePath = calcLifePath(date);
    const matrix   = calcMatrixGrid(date);
    const astro    = astroStub();
    const archetype = detectSoulArchetype(lifePath);
    const pastLives = pastLifeResonance(name, lifePath, matrix);

    let txt="";
    txt += "Nuematria™ Big Soul Blueprint\n";
    txt += "==============================\n\n";

    txt += `Name: ${name}\n`;
    txt += `Birth: ${date}   Time: ${time}   Location: ${loc}\n\n`;

    txt += "LIFE PATH\n";
    txt += "---------\n";
    txt += `Life Path Number: ${lifePath}\n\n`;

    txt += "SOUL ARCHETYPE\n";
    txt += "--------------\n";
    txt += `${archetype}\n\n`;

    txt += "MATRIX GRID\n";
    txt += "-----------\n";
    for (let i=1;i<=9;i++){
        txt += `${i}: ${matrix.matrix[String(i)]}\n`;
    }
    txt += `\nEccentricity (7s): ${matrix.eccentricity}`;
    txt += `\nAlien Energy: ${matrix.alienEnergy ? "Yes" : "No"}\n\n`;

    txt += "ASTRO SIGNATURE\n";
    txt += "----------------\n";
    txt += `Sun: ${astro.sun}\n`;
    txt += `Moon: ${astro.moon}\n`;
    txt += `Rising: ${astro.rising}\n\n`;

    txt += "ASPECTS\n";
    txt += "-------\n";
    astro.aspects.forEach(a => txt += `• ${a}\n`);
    txt += "\n";

    txt += "PAST LIFE RESONANCE\n";
    txt += "--------------------\n";
    pastLives.forEach(p => txt += `• ${p}\n`);
    txt += "\n";

    txt += "END OF BLUEPRINT\n";

    document.getElementById("output").textContent = txt;
}
</script>
</body>
</html>
